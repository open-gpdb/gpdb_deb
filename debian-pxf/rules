#!/usr/bin/make -f
# You must remove unused comment lines for the released package.
DH_VERBOSE = 1
DPKG_EXPORT_BUILDFLAGS = 1

# assumes that CWD is root of gpdb source
PXF_SRC_DIR := $(shell pwd)
DEBIAN_DESTINATION := ${PXF_SRC_DIR}/debian/build
GP_PATH_SCRIPT := $(shell find . -name "greenplum_path.sh"|tail -1)

export JAVA_HOME := /usr/lib/jvm/java-1.11.0-openjdk-amd64
export GPHOME := ${DEBIAN_DESTINATION}/gp

export GOROOT := ${PXF_SRC_DIR}/go
export GOPATH := ${PXF_SRC_DIR}/cli/go
export PATH := $(GOPATH)/bin:$(GOROOT)/bin:$(GPHOME)/bin:$(PATH)

$(info    GOPATH is $(GOPATH))
$(info    PATH is $(PATH))
$(info    GPVAR is $(GP_PATH_SCRIPT))
$(info    GOROOT is $(GOROOT))

include /usr/share/dpkg/default.mk

%:
	dh $@

override_dh_auto_configure:
	echo "Skipping autoconfigure"

override_dh_auto_build: 
	pwd
	ls -la /root/
	ls -la /root/pxf/
	make 

override_dh_auto_install:
	make install 

override_dh_auto_test:
	echo "Skipping auto test"

override_dh_auto_clean:
	echo "Skipping auto clean"

override_dh_strip_nondeterminism:
	echo "Skipping dh_strip_nondeterminism"
